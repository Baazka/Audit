@model System.Xml.Linq.XElement
@{
    ViewBag.Title = "BM7";
    Layout = "~/Views/Shared/_Layout.cshtml";
    int counter = 0;
}

<div class="d-flex">
    <a href="@Url.Action("Index","Statistic")" class="btn btn-sm btn-light mr-2">
        <span class="icon text-gray-600">
            <i class="fas fa-arrow-left"></i>
        </span>
    </a>
    <h4>БМ-7. Төрийн аудитын газрын тайлант хугацаанд аудитаар илрүүлсэн алдаа, зөрчлийн ангиллын бүртгэл</h4>
    <div class="ml-auto pr-2">
        <a href="#" class="btn btn-sm btn-success btn-icon-split" onclick="exportFile('BM7', 'БМ-7. Төрийн аудитын газрын тайлант хугацаанд аудитаар илрүүлсэн алдаа, зөрчлийн ангиллын бүртгэл')">
            <span class="icon text-white-50">
                <i class="fas fa-file-excel"></i>
            </span>
            <span class="text">Excel</span>
        </a>
    </div>
</div>
<hr class="sidebar-divider">
<div class="table-responsive">
    <table id="BM7" class="table table-bordered datatable display" style="width:100%">
        <thead>
            <tr>
                <th rowspan="3" class="text-center">№</th>
                <th rowspan="3">Төрийн аудитын газар</th>
                <th rowspan="3">Аудитын төрөл</th>
                <th rowspan="3">Аудитын жил</th>
                <th rowspan="3">Аудитын код</th>
                <th rowspan="3">Аудитын нэр</th>
                <th rowspan="3">Үзүүлэлт</th>
                <th colspan="4">Орлого бүрдүүлэлттэй холбоотой</th>
                <th colspan="4">Төсвийн төлөвлөлт, гүйцэтгэлтэй холбоотой</th>
                <th colspan="2" rowspan="2">НББ, тайлагналтай холбоотой</th>
                <th colspan="2" rowspan="2">Арвилан хэмнэлт, үр ашиг, үр нөлөөтэй холбоотой</th>
                <th colspan="2" rowspan="2">Хууль, тогтоомжийн хэрэгжилттэй холбоотой</th>
                <th colspan="2" rowspan="2">Дотоод хяналт, хариуцлагатай холбоотой</th>
                <th colspan="2" rowspan="2">Худалдан авалттай холбоотой</th>
                <th colspan="2" rowspan="2">Зориулалт бус зарцуулалттай холбоотой</th>
                <th colspan="2" rowspan="2">Бусад</th>
                <th colspan="2" rowspan="2">Алдаа зөрчлийн нийт дүн</th>
            </tr>
            <tr>
                <th colspan="2">Улсын төсөв</th>
                <th colspan="2">Орон нутгийн төсөв</th>
                <th colspan="2">Улсын төсөв</th>
                <th colspan="2">Орон нутгийн төсөв</th>
            </tr>
            <tr>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
                <th>Тоо</th>
                <th>Дүн</th>
            </tr>
        </thead>
        <tbody>
                @if (Model!=null && Model.Elements("BM7").Count() != 0)
                {
                    foreach (var item in Model.Elements("BM7"))
                    {
                        counter++;
                        <tr>
                            <td>@counter</td>
                            <td>@(item.Element("OFFICE_ID") != null ? item.Element("OFFICE_ID").Value:"")</td>
                            <td>@(item.Element("AUDIT_TYPE") != null ? item.Element("AUDIT_TYPE").Value:"")</td>
                            <td>@(item.Element("AUDIT_YEAR") != null ? item.Element("AUDIT_YEAR").Value:"")</td>
                            <td>@(item.Element("AUDIT_CODE") != null ? item.Element("AUDIT_CODE").Value:"")</td>
                            <td>@(item.Element("AUDIT_NAME") != null ? item.Element("AUDIT_NAME").Value:"")</td>
                            <td>@(item.Element("DECISION_TYPE") != null ? item.Element("DECISION_TYPE").Value:"")</td>
                            <td>@(item.Element("INCOME_STATE_COUNT") != null ? item.Element("INCOME_STATE_COUNT").Value:"")</td>
                            <td>@(item.Element("INCOME_STATE_AMOUNT") != null ? item.Element("INCOME_STATE_AMOUNT").Value:"")</td>
                            <td>@(item.Element("INCOME_LOCAL_COUNT") != null ? item.Element("INCOME_LOCAL_COUNT").Value:"")</td>
                            <td>@(item.Element("INCOME_LOCAL_NUMBER") != null ? item.Element("INCOME_LOCAL_NUMBER").Value:"")</td>
                            <td>@(item.Element("BUDGET_STATE_COUNT") != null ? item.Element("BUDGET_STATE_COUNT").Value:"")</td>
                            <td>@(item.Element("BUDGET_STATE_AMOUNT") != null ? item.Element("BUDGET_STATE_AMOUNT").Value:"")</td>
                            <td>@(item.Element("BUDGET_LOCAL_COUNT") != null ? item.Element("BUDGET_LOCAL_COUNT").Value:"")</td>
                            <td>@(item.Element("BUDGET_LOCAL_AMOUNT") != null ? item.Element("BUDGET_LOCAL_AMOUNT").Value:"")</td>
                            <td>@(item.Element("ACCOUNTANT_COUNT") != null ? item.Element("ACCOUNTANT_COUNT").Value:"")</td>
                            <td>@(item.Element("ACCOUNTANT_AMOUNT") != null ? item.Element("ACCOUNTANT_AMOUNT").Value:"")</td>
                            <td>@(item.Element("EFFICIENCY_COUNT") != null ? item.Element("EFFICIENCY_COUNT").Value:"")</td>
                            <td>@(item.Element("EFFICIENCY_AMOUNT") != null ? item.Element("EFFICIENCY_AMOUNT").Value:"")</td>
                            <td>@(item.Element("LAW_COUNT") != null ? item.Element("LAW_COUNT").Value:"")</td>
                            <td>@(item.Element("LAW_AMOUNT") != null ? item.Element("LAW_AMOUNT").Value:"")</td>
                            <td>@(item.Element("MONITORING_COUNT") != null ? item.Element("MONITORING_COUNT").Value:"")</td>
                            <td>@(item.Element("MONITORING_AMOUNT") != null ? item.Element("MONITORING_AMOUNT").Value:"")</td>
                            <td>@(item.Element("PURCHASE_COUNT") != null ? item.Element("PURCHASE_COUNT").Value:"")</td>
                            <td>@(item.Element("PURCHASE_AMOUNT") != null ? item.Element("PURCHASE_AMOUNT").Value:"")</td>
                            <td>@(item.Element("COST_COUNT") != null ? item.Element("COST_COUNT").Value:"")</td>
                            <td>@(item.Element("COST_AMOUNT") != null ? item.Element("COST_AMOUNT").Value:"")</td>
                            <td>@(item.Element("OTHER_COUNT") != null ? item.Element("OTHER_COUNT").Value:"")</td>
                            <td>@(item.Element("OTHER_AMOUNT") != null ? item.Element("OTHER_AMOUNT").Value:"")</td>
                            <td>@(item.Element("ALL_COUNT") != null ? item.Element("ALL_COUNT").Value:"")</td>
                            <td>@(item.Element("ALL_AMOUNT") != null ? item.Element("ALL_AMOUNT").Value:"")</td>
                        </tr>
                    }
                }
            </tbody>
    </table>
</div>

@section scripts{
    <script>
        initDataTable();
    </script>
} 